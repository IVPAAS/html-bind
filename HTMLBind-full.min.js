/*! html-bind - v0.0.1 - 2013-05-05
* Copyright (c) 2013 Itay Kinnrot; Licensed GNU */
!function(t,n){t.kWatcher=t.kWatcher||function(t,r){var i="data-value",a={},o=!1,f={},h=null,e={kshow:"show",khide:"hide"},c={};if(r)for(var u in r)"dataBindString"==u&&(i=r[u]);var s=function(){for(var n in t)t.hasOwnProperty(n)&&(f[n]=t[n])},v=function(){var n=!1;for(var r in t)if(t.hasOwnProperty(r)&&t[r]!==f[r]){if(n=!0,a[r])for(var i=0;a[r].length>i;i++)a[r][i](r,f[r],t[r]);if(c[r])for(var o=0;c[r].length>o;o++){var h=$(c[r][o]).attr("format"),e=t[r];h&&"function"==typeof t[h]&&(e=t[h](e)),$(c[r][o]).text(e)}}return n},l=function(){c={};for(var t=n("["+i+"]"),r=0;t.length>r;r++){var a=t[r],o=$(a).attr(i);(c[o]||(c[o]=[]))&&c[o].push(a)}},p=function(){for(var r in e)for(var i=n("["+r+"]"),a=0;i.length>a;a++){var o=i[a],f=$(o).attr(r),h=!0;0==f.indexOf("!")&&(f=f.split("!")[1],h=!1);var c=t[f];if("function"==typeof c&&(c=t[f]()),t[f]==h){var u=e[r];console.log(u),u&&n(o)[u]()}}};this.bind=function(t,n){a[t]||(a[t]=[]),a[t].push(n)},this.startWatch=function(){if(!o){o=!0,l();var t=function(){v()&&(s(),p()),o&&(h=setTimeout(t,50))};t()}},this.stopWatch=function(){o=!1,clearTimeout(h)},this.updateScope=function(n){var r=!1;o&&(this.stopWatch(),r=!0),t=n,f={},s(),r&&this.startWatch()},this.setAttribute=function(t,n){e[t]=n},this.startWatch()}}(window,jQuery);